<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.tang.myjob.dao.product.OrderDao">

	<resultMap type="OrderDTO" id="OrderDTO">
		<id 	column="id" property="id" />
		<result column="user_id" property="userId" />
		<result column="state" property="state" />
		<result column="remark" property="remark" />
		<result column="create_time" property="createTime" />
		<result column="start_time" property="startTime" />
		<result column="end_time" property="endTime" />
		<result column="total_amount" property="totalAmount" />
	</resultMap>

	<resultMap type="Page" id="PageOrder">
		<result column="iTotalRecords" property="iTotalRecords" />
		<result column="iTotalDisplayRecords" property="iTotalDisplayRecords" />
		<result column="iDisplayStart" property="iDisplayStart" />
		<result column="iDisplayLength" property="iDisplayLength" />

		<collection property="aaData" ofType="OrderDTO">
			<id 	column="id" property="id" />
			<result column="user_id" property="userId" />
			<result column="state" property="state" />
			<result column="remark" property="remark" />
			<result column="create_time" property="createTime" />
			<result column="start_time" property="startTime" />
			<result column="end_time" property="endTime" />
			<result column="total_amount" property="totalAmount" />
		</collection>
	</resultMap>

	<select id="selectOrder"  resultMap="OrderDTO"  parameterType="org.tang.myjob.dto.product.OrderDTO">
		<![CDATA[
 			select id,user_id,state,remark,create_time,start_time,end_time,total_amount from t_order
 		]]>
		<where>
			<if test="userId!=null">
				user_id = #{userId}
			</if>
		</where>
	</select>


	<!-- 查询分页 -->
	<select id="selectOrderPage" parameterType="Page" resultMap="PageOrder" >
		select
		id,user_id,state,remark,create_time,start_time,end_time,total_amount
		from t_order t
		<where>
			1=1
			<if test="userId != null and  userId != '' ">
				and  t.user_id   =  #{userId}
			</if>
			<if test="remark != null and  remark != '' ">
				and  t.remark   like    '%${remark}%'
			</if>
		</where>
		order by id
	</select>

	<insert id="add" useGeneratedKeys="true" keyProperty="id"  parameterType="OrderDTO">
		insert into t_order(
			user_id,state,remark,create_time,start_time,end_time,total_amount
		)
		values(
			#{userId, jdbcType=VARCHAR},
			#{state, jdbcType=VARCHAR},
			#{remark, jdbcType=VARCHAR},
			#{createTime, jdbcType=VARCHAR},
			#{startTime, jdbcType=VARCHAR},
			#{endTime, jdbcType=VARCHAR},
			#{totalAmount, jdbcType=VARCHAR}
		)
	</insert>

</mapper>